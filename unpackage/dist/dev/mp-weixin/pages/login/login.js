(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{269:function(e,n,t){"use strict";(function(e){var n=t(3);t(25),t(26);n(t(24));var o=n(t(270));wx.__webpack_require_UNI_MP_PLUGIN__=t,e(o.default)}).call(this,t(1)["createPage"])},270:function(e,n,t){"use strict";t.r(n);var o=t(271),i=t(273);for(var s in i)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(s);t(278);var c,a=t(40),r=Object(a["default"])(i["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],c);r.options.__file="pages/login/login.vue",n["default"]=r.exports},271:function(e,n,t){"use strict";t.r(n);var o=t(272);t.d(n,"render",(function(){return o["render"]})),t.d(n,"staticRenderFns",(function(){return o["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return o["recyclableRender"]})),t.d(n,"components",(function(){return o["components"]}))},272:function(e,n,t){"use strict";var o;t.r(n),t.d(n,"render",(function(){return i})),t.d(n,"staticRenderFns",(function(){return c})),t.d(n,"recyclableRender",(function(){return s})),t.d(n,"components",(function(){return o}));var i=function(){var e=this,n=e.$createElement;e._self._c},s=!1,c=[];i._withStripped=!0},273:function(e,n,t){"use strict";t.r(n);var o=t(274),i=t.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(s);n["default"]=i.a},274:function(e,n,t){"use strict";(function(e){var o=t(3);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(t(10)),s=t(275),c=t(185),a=o(t(186)),r=(t(277),{data:function(){var e;return e={loginMode:1,usernameType:"text",codeBut:"获取验证码",loginImage:"../../static/images/logo.png",markPhone:!1,markCode:!1,phone:"",password:"",code:"",iscode:""},(0,i.default)(e,"markCode",!1),(0,i.default)(e,"seen",!1),(0,i.default)(e,"type_text","text"),(0,i.default)(e,"type_password","password"),(0,i.default)(e,"focus",!0),e},onLoad:function(){},methods:{forget:function(){e.navigateTo({url:"../forget/forget?phone="+this.phone})},register:function(){e.navigateTo({url:"../register/register"})},GetCollectHospitalByOpenid:function(n){var t={FLAG:"R",collectionType:"Hospital",openId:n};a.default.post(c.CollectionServlet,t).then((function(n){var t=[];if(0==n.length);else if("000000"==n[n.length-1].SYS_HEAD.ReturnCode)for(var o=0;o<n.length-1;o++)t.push(n[o]);else e.showToast({title:n[n.length-1].SYS_HEAD.ReturnMessage,icon:"none",duration:2e3});e.setStorageSync("collectHospitals",t),console.log("=======loginCollections========",t)})).catch((function(e){}))},GetCollectDoctorByOpenid:function(n){var t={FLAG:"R",collectionType:"Doctor",openId:n};a.default.post(c.CollectionServlet,t).then((function(n){var t=[];if(0==n.length);else if("000000"==n[n.length-1].SYS_HEAD.ReturnCode)for(var o=0;o<n.length-1;o++)t.push(n[o]);else e.showToast({title:n[n.length-1].SYS_HEAD.ReturnMessage,icon:"none",duration:2e3});e.setStorageSync("collectDoctors",t),console.log("=======loginCollections========",t)})).catch((function(e){}))},loginCode:function(){this.loginMode=2,this.usernameType="number"},loginPhone:function(){this.loginMode=1,this.usernameType="text"},phoneInput:function(e){var n=e.detail.value;this.phone=n,""!=n&&n.length>=11?this.markPhone=!0:this.markPhone=!1},changeSeen:function(){this.seen=!this.seen},codeInput:function(e){var n=e.detail.value;this.code=n,""!=n&&n.length>=4?(this.code=n,this.markCode=!0):this.markCode=!1},sendCode:async function(e){console.log("xxxxxx",e),this.timer()},applyCode:function(){var n=this,t={uEnvirn:"MP-WEIXIN",openId:this.phone,FLAG:"applyCode"};a.default.post(c.userServlet,t).then((async function(t){console.log("==验证码===",t);var o=t.split(",")[0],i=t.split(",")[1],s=t.split(",")[2];console.log("==status==",o),console.log("==code==",i),console.log("==message==",s),console.log("==322222==","200"==o),"200"==o?(n.iscode=i,await n.sendCode(i),e.showToast({title:s,icon:"none",duration:2e3})):"201"==o||"202"==o||"203"==o?e.showToast({title:s,icon:"none",duration:2e3}):e.showToast({title:"系统异常1",icon:"none",duration:2e3})})).catch((function(n){e.showToast({title:"系统异常2",icon:"none",duration:1e3})}))},getCode:async function(n){var t=this,o=/^(14[0-9]|13[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$$/,i=this.phone;""==i?e.showToast({title:"手机号不能为空",icon:"none",duration:1e3}):o.test(i)?await t.applyCode():e.showToast({title:"请输入正确的手机号",icon:"none",duration:1e3})},timer:function(){if(this.c2&&this.c2.interval)return!1;this.c2=new s.$wuxCountDown({date:+new Date+1e4,onEnd:function(){this.setData({c2:"重新发送"})},render:function(e){var n=this.leadingZeros(e.sec,2)+" 秒 ";0!==e.sec&&this.setData({c2:n})}})},phonecheck:function(){var n=this,t={uEnvirn:"MP-WEIXIN",openId:this.phone,FLAG:"CheckPhone"};a.default.post(c.userServlet,t).then((function(t){console.log("=====",t),0==t&&(e.showToast({title:"手机号未注册",icon:"none",duration:2e3}),n.focus=!0)})).catch((function(n){e.showToast({title:"登录失败xxx",icon:"none",duration:1e3})}))},check:function(){var n=/^(14[0-9]|13[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$$/;return""==this.phone?(e.showToast({title:"手机号不能为空",icon:"none",duration:2e3}),!1):n.test(this.phone)?""==this.password&&1==this.loginMode?(e.showToast({title:"密码不能为空",icon:"none",duration:2e3}),!1):""!=this.code||2!=this.loginMode||(e.showToast({title:"验证码不能为空",icon:"none",duration:2e3}),!1):(e.showToast({title:"请输入正确的手机号",icon:"none",duration:1e3}),!1)},loginUp:function(){"1"==this.loginMode?this.phonePasLogin():this.phoneCodLogin()},phoneCodLogin:function(){var n=this,t={uEnvirn:"MP-WEIXIN",openId:this.phone,code:this.code,FLAG:"validateCode"};console.log("======",t),this.check()&&a.default.post(c.userServlet,t).then((function(t){console.log("===res===",t);var o=t.split("*")[0],i=t.split("*")[1],s=t.split("*")[2],c=JSON.parse(s);e.setStorageSync("LoginIndex",1),e.setStorageSync("WeChatUserInfo",c),e.setStorageSync("openid",n.phone),"200"==o?(n.GetCollectHospitalByOpenid(n.phone),n.GetCollectDoctorByOpenid(n.phone),e.showToast({title:"登录成功",icon:"none",duration:2e3}),setTimeout((function(){e.switchTab({url:"../index/index"})}),2e3)):e.showToast({title:i,icon:"none",duration:2e3})})).catch((function(n){e.showToast({title:"登录失败",icon:"none",duration:1e3})}))},phonePasLogin:function(){var n=this,t={FLAG:"phonePasLogin",uEnvirn:"MP-WEIXIN",openId:this.phone,password:this.password};this.check()&&a.default.post(c.userServlet,t).then((function(t){console.log("=====dsdsds====",t);var o=t.split("*")[0],i=t.split("*")[1],s=JSON.parse(i);e.setStorageSync("LoginIndex",1),e.setStorageSync("WeChatUserInfo",s),e.setStorageSync("openid",n.phone),"200"==o?(n.GetCollectHospitalByOpenid(n.phone),n.GetCollectDoctorByOpenid(n.phone),e.showToast({title:"登录成功",icon:"none",duration:2e3}),setTimeout((function(){e.switchTab({url:"../index/index"})}),2e3)):e.showToast({title:"用户名或密码错误",icon:"none",duration:1e3})})).catch((function(n){e.showToast({title:"登录失败",icon:"none",duration:1e3})}))},login_weixin:function(){e.login({success:function(n){e.request({url:"https://api.weixin.qq.com/sns/jscode2session?appid=wxc15c4fcf719eb5a3&secret=4ca91306643d90b167038c49bdb4d33f&js_code="+n.code+"&grant_type=authorization_code",data:{text:"uni.request"},header:{"custom-header":"hello"},success:function(n){e.setStorageSync("openid",n.data.openid),e.navigateTo({url:"../WechatLogin/WechatLogin"})}})}})}}});n.default=r}).call(this,t(1)["default"])},278:function(e,n,t){"use strict";t.r(n);var o=t(279),i=t.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(s);n["default"]=i.a},279:function(e,n,t){}},[[269,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/login/login.js.map