require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesA/login/login"],{371:function(e,n,t){"use strict";(function(e,n){var o=t(4);t(26);o(t(25));var i=o(t(372));e.__webpack_require_UNI_MP_PLUGIN__=t,n(i.default)}).call(this,t(1)["default"],t(2)["createPage"])},372:function(e,n,t){"use strict";t.r(n);var o=t(373),i=t(375);for(var s in i)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(s);t(377);var a,c=t(32),r=Object(c["default"])(i["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],a);r.options.__file="pagesA/login/login.vue",n["default"]=r.exports},373:function(e,n,t){"use strict";t.r(n);var o=t(374);t.d(n,"render",(function(){return o["render"]})),t.d(n,"staticRenderFns",(function(){return o["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return o["recyclableRender"]})),t.d(n,"components",(function(){return o["components"]}))},374:function(e,n,t){"use strict";var o;t.r(n),t.d(n,"render",(function(){return i})),t.d(n,"staticRenderFns",(function(){return a})),t.d(n,"recyclableRender",(function(){return s})),t.d(n,"components",(function(){return o}));var i=function(){var e=this,n=e.$createElement;e._self._c},s=!1,a=[];i._withStripped=!0},375:function(e,n,t){"use strict";t.r(n);var o=t(376),i=t.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(s);n["default"]=i.a},376:function(e,n,t){"use strict";(function(e){var o=t(4);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(t(251)),s=o(t(253)),a=o(t(11)),c=t(254),r=t(177),l=o(t(178)),u=(t(256),{data:function(){var e;return e={loginMode:1,usernameType:"text",codeBut:"获取验证码",loginImage:"../../static/images/logo.png",markPhone:!1,markCode:!1,phone:"",password:"",code:"",iscode:""},(0,a.default)(e,"markCode",!1),(0,a.default)(e,"seen",!1),(0,a.default)(e,"type_text","text"),(0,a.default)(e,"type_password","password"),(0,a.default)(e,"focus",!0),e},onLoad:function(){},methods:{forget:function(){e.navigateTo({url:"../forget/forget?phone="+this.phone})},register:function(){e.navigateTo({url:"pagesC/register/register"})},GetCollectHospitalByOpenid:function(n){var t={FLAG:"R",collectionType:"Hospital",openId:n};l.default.post(r.CollectionServlet,t).then((function(n){var t=[];if(0==n.length);else if("000000"==n[n.length-1].SYS_HEAD.ReturnCode)for(var o=0;o<n.length-1;o++)t.push(n[o]);else e.showToast({title:n[n.length-1].SYS_HEAD.ReturnMessage,icon:"none",duration:2e3});e.setStorageSync("collectHospitals",t),console.log("=======loginCollections========",t)})).catch((function(e){}))},GetCollectDoctorByOpenid:function(n){var t={FLAG:"R",collectionType:"Doctor",openId:n};l.default.post(r.CollectionServlet,t).then((function(n){var t=[];if(0==n.length);else if("000000"==n[n.length-1].SYS_HEAD.ReturnCode)for(var o=0;o<n.length-1;o++)t.push(n[o]);else e.showToast({title:n[n.length-1].SYS_HEAD.ReturnMessage,icon:"none",duration:2e3});e.setStorageSync("collectDoctors",t),console.log("=======loginCollections========",t)})).catch((function(e){}))},getFamilys:function(n){var t={openId:n,FLAG:"R",type:"getDesensFamily"};l.default.post(r.AskerServlet,t).then((function(n){e.setStorageSync("family_list",n)})).catch((function(e){}))},loginCode:function(){this.loginMode=2,this.usernameType="number"},loginPhone:function(){this.loginMode=1,this.usernameType="text"},phoneInput:function(e){var n=e.detail.value;this.phone=n,""!=n&&n.length>=11?this.markPhone=!0:this.markPhone=!1},changeSeen:function(){this.seen=!this.seen},codeInput:function(e){var n=e.detail.value;this.code=n,""!=n&&n.length>=4?(this.code=n,this.markCode=!0):this.markCode=!1},sendCode:function(e){var n=this;return(0,s.default)(i.default.mark((function t(){return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("xxxxxx",e),n.timer();case 2:case"end":return t.stop()}}),t)})))()},applyCode:function(){var n=this,t={uEnvirn:"MP-WEIXIN",openId:this.phone,FLAG:"applyCode"};l.default.post(r.userServlet,t).then(function(){var t=(0,s.default)(i.default.mark((function t(o){var s,a,c;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("==验证码===",o),s=o.split(",")[0],a=o.split(",")[1],c=o.split(",")[2],console.log("==status==",s),console.log("==code==",a),console.log("==message==",c),console.log("==322222==","200"==s),"200"!=s){t.next=15;break}return n.iscode=a,t.next=12,n.sendCode(a);case 12:e.showToast({title:c,icon:"none",duration:2e3}),t.next=16;break;case 15:"201"==s||"202"==s||"203"==s?e.showToast({title:c,icon:"none",duration:2e3}):e.showToast({title:"系统异常1",icon:"none",duration:2e3});case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(n){e.showToast({title:"系统异常2",icon:"none",duration:1e3})}))},getCode:function(n){var t=this;return(0,s.default)(i.default.mark((function n(){var o,s,a;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=t,s=/^(14[0-9]|13[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$$/,a=t.phone,""!=a){n.next=7;break}e.showToast({title:"手机号不能为空",icon:"none",duration:1e3}),n.next=13;break;case 7:if(s.test(a)){n.next=11;break}e.showToast({title:"请输入正确的手机号",icon:"none",duration:1e3}),n.next=13;break;case 11:return n.next=13,o.applyCode();case 13:case"end":return n.stop()}}),n)})))()},timer:function(){if(this.c2&&this.c2.interval)return!1;this.c2=new c.$wuxCountDown({date:+new Date+1e4,onEnd:function(){this.setData({c2:"重新发送"})},render:function(e){var n=this.leadingZeros(e.sec,2)+" 秒 ";0!==e.sec&&this.setData({c2:n})}})},phonecheck:function(){var n=this,t={uEnvirn:"MP-WEIXIN",openId:this.phone,FLAG:"CheckPhone"};l.default.post(r.userServlet,t).then((function(t){console.log("=====",t),0==t&&(e.showToast({title:"手机号未注册",icon:"none",duration:2e3}),n.focus=!0)})).catch((function(n){e.showToast({title:"登录失败xxx",icon:"none",duration:1e3})}))},check:function(){var n=/^(14[0-9]|13[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$$/;return""==this.phone?(e.showToast({title:"手机号不能为空",icon:"none",duration:2e3}),!1):n.test(this.phone)?""==this.password&&1==this.loginMode?(e.showToast({title:"密码不能为空",icon:"none",duration:2e3}),!1):""!=this.code||2!=this.loginMode||(e.showToast({title:"验证码不能为空",icon:"none",duration:2e3}),!1):(e.showToast({title:"请输入正确的手机号",icon:"none",duration:1e3}),!1)},loginUp:function(){"1"==this.loginMode?this.phonePasLogin():this.phoneCodLogin()},phoneCodLogin:function(){var n=this,t={uEnvirn:"MP-WEIXIN",openId:this.phone,code:this.code,FLAG:"validateCode"};console.log("======",t),this.check()&&l.default.post(r.userServlet,t).then((function(t){console.log("===res===",t);var o=t.split("*")[0],i=t.split("*")[1],s=t.split("*")[2],a=JSON.parse(s);e.setStorageSync("LoginIndex",1),e.setStorageSync("WeChatUserInfo",a),e.setStorageSync("openid",n.phone),"200"==o?(n.GetCollectHospitalByOpenid(n.phone),n.GetCollectDoctorByOpenid(n.phone),n.getFamilys(n.phone),e.showToast({title:"登录成功",icon:"none",duration:2e3}),setTimeout((function(){e.switchTab({url:"/pages/index/index"})}),2e3)):e.showToast({title:i,icon:"none",duration:2e3})})).catch((function(n){e.showToast({title:"登录失败",icon:"none",duration:1e3})}))},phonePasLogin:function(){var n=this,t={FLAG:"phonePasLogin",uEnvirn:"MP-WEIXIN",openId:this.phone,password:this.password};this.check()&&l.default.post(r.userServlet,t).then((function(t){console.log("=====dsdsds====",t);var o=t.split("*")[0],i=t.split("*")[1],s=JSON.parse(i);e.setStorageSync("LoginIndex",1),e.setStorageSync("WeChatUserInfo",s),e.setStorageSync("openid",n.phone),"200"==o?(n.GetCollectHospitalByOpenid(n.phone),n.GetCollectDoctorByOpenid(n.phone),n.getFamilys(n.phone),e.showToast({title:"登录成功",icon:"none",duration:2e3}),setTimeout((function(){e.switchTab({url:"/pages/index/index"})}),2e3)):e.showToast({title:"用户名或密码错误",icon:"none",duration:1e3})})).catch((function(n){e.showToast({title:"登录失败",icon:"none",duration:1e3})}))},login_weixin:function(){e.login({success:function(n){e.request({url:"https://api.weixin.qq.com/sns/jscode2session?appid=wxc15c4fcf719eb5a3&secret=4ca91306643d90b167038c49bdb4d33f&js_code="+n.code+"&grant_type=authorization_code",data:{text:"uni.request"},header:{"custom-header":"hello"},success:function(n){console.log("-----------login1------------------------"),console.log(n.data.openid),console.log("------------login1-----------------------"),e.setStorageSync("openid",n.data.openid),e.navigateTo({url:"/pagesC/WechatLogin/WechatLogin"})}})}})}}});n.default=u}).call(this,t(2)["default"])},377:function(e,n,t){"use strict";t.r(n);var o=t(378),i=t.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(s);n["default"]=i.a},378:function(e,n,t){}},[[371,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pagesA/login/login.js.map